<!DOCTYPE html>
<html class="blocks">
<head>
	<title>Blocks! Products</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="//fonts.googleapis.com/css?family=Roboto:300,400" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Oswald:300,700,400" rel="stylesheet" type="text/css">
	<link href="css/styles.css" rel="stylesheet" type="text/css">
</head>
<body>

	<!-- Google Tag Manager -->
	<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-WWC78X" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WWC78X');</script>
	<!-- End Google Tag Manager -->
		
<!-- BEGIN TEMPLATES -->

	<template id="tmplBasket">
		<h3>Your basket</h3>
		<table>
		<!--
		var i = data.length, newItem;
		while(i--){
			newItem = data[i]["modified"] ? "new-item" : "";
		-->
			<tr class="<!--#newItem-->">
				<td data-fn="shop.add" data-pr="<!--#data[i].id-->+<!--#data[i].name-->+<!--#data[i].price-->+-1">X</td>
				<td><!--#decodeURIComponent(data[i].name)--></td>
				<td><!--#data[i].quantity--></td>
				<td><!--#data[i].price--></td>
				<td><!--#data[i].quantity*data[i].price--></td>
			</tr>
		<!--}-->
		</table>
	</template>
	
	<template id="tmplCheckout">
		Check it out!
	</template>
	
	<template id="tmplSearchResult">
		<!-- data = data.data[0]; -->
		<h2><!--# data.numOfRecs --> titler matcher din søgning.</h2>
		<section id="wrpProductList" class="product-list"></section>
		<nav id="wrpPagination"></nav>
	</template>

	<!--TODO: Write pagination-function 1 ... 208 etc.-->
	
	<template id="tmplPagination">
		<!-- data = data.data[0]; -->
		
		<!-- for (i = 1; i <= data.numOfPages; i++) { -->
		
		<span data-fn="xhr.updateURI" data-pr="pg=<!--#i-->"><!--#i--></span>
		
		<!--}-->
		
		Side <!--# data.curPage -->
	</template>

	<template class="tmplProductList tmplProductDetails">
	<!--
	data = data.result;
	var i = data.length, bDetail = (i === 0);
	while (i--) {-->
		<article itemtype="http://schema.org/Product" class="product">
			<figure	itemprop="image" class="product-image-wrapper">
				<img alt="<!--#data[i].name-->" src="<!--#data[i].image-->" class="product-image" />
			</figure>
			<h2	class="product-header">
				<a href="#query=@s=details@q=<!--#data[i].id-->" itemprop="name" data-fn="shop.details" data-pr="Search+<!--#data[i].id-->+<!--#data[i].name-->"><!--#data[i].name--></a>
			</h2>
			<div class="product-info">
				<div itemprop="aggregateRating"	itemtype="http://schema.org/AggregateRating">
					<span itemprop="ratingValue" content="3" class="product-rating"></span>
					<meta itemprop="reviewCount" content="0" />
				</div>
				<div itemprop="offers" itemtype="http://schema.org/Offer">Pris
					<span itemprop="price"><!--# data[i].price	--></span>
					<span itemprop="priceCurrency" class="notranslate">DKK</span>
				</div>
				<div itemprop="itemCondition" class="product-condition">Stand: Ny</div>
				<div itemprop="availability" href="http://schema.org/InStock" class="product-availability">På lager</div>
			</div>
			<button	itemprop="productID" class="product-buy" content="<!--#data[i].id-->" data-fn="shop.add" data-pr="<!--#data[i].id-->+<!--#data[i].name-->+<!--#data[i].price-->">Køb nu</button>
		</article>
	<!--}-->
	</template>

<!-- / END TEMPLATES -->
	
	<h1>Enhanced Ecommerce Shop</h1>
	
	<main class="main-wrapper wrpSearchResult wrpProductDetails"></main>
	<aside class="main-aside">TEST</aside>

	<script src="../micro/micro-min.js"></script>
	<script>
		
		/* Test-function for Custom Events */
		var logMsg = function(rawMessage) {
			console.log(rawMessage.detail);
		};

		/* Custom Event Listeners: xhr-fail, xhr-start, xhr-stop */
		
		if ("CustomEvent" in window) {
			window.addEventListener("xhr-fail", logMsg, false);	
			window.addEventListener("xhr-start", logMsg, false);	
			window.addEventListener("xhr-stop", logMsg, false);	
		}
		
		var oSettings =
		{
			bUseCache : false,
			basketTemplate: document.getElementById("tmplBasket"),
			basketWrapper : document.querySelector(".main-aside"),
			uri : "../io.asp",
			//hashInit : "#query=@s=search@q=splint@pg=1@items=12"
			hashInit : "#query=@s=front"
		};
		
		evt.listen();
		shop.init(oSettings);
	</script>
</body>
</html>			